<!-- page-parent.html -->
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Intégration iframe sécurisée</title>
  <style>
    html,body{height:100%;margin:0}
    #frameWrapper{width:100%;height:100vh;border:0;display:flex;align-items:center;justify-content:center}
    iframe{width:100%;height:100%;border:0}
  </style>
</head>
<body>
  <div id="frameWrapper">
    <!-- sandbox = sécurité : restreint ce que peut faire la page embarquée -->
    <iframe id="myIframe"
      src="https://fame-card-arena.lovable.app/?utm_source=lovable-editor"
      sandbox="allow-scripts allow-forms allow-popups"
      referrerpolicy="no-referrer"
      title="Fame Card Arena">
    </iframe>
  </div>

  <script>
    // Exemple de communication sécurisée avec l'iframe via postMessage
    const iframe = document.getElementById('myIframe');

    // Envoyer un message à l'iframe (seulement si la page embarquée sait gérer postMessage)
    function sendMessageToIframe(type, data) {
      iframe.contentWindow.postMessage({ type, data }, 'https://fame-card-arena.lovable.app');
    }

    // Écouter les messages renvoyés par l'iframe
    window.addEventListener('message', (event) => {
      // vérifier l'origine pour éviter les messages non attendus
      if (event.origin !== 'https://fame-card-arena.lovable.app') return;
      const { type, data } = event.data || {};
      console.log('Message reçu de l’iframe:', type, data);
      // traiter les messages autorisés ici
    }, false);
  </script>
</body>
</html>
